package com.y5neko.shiroexp.config;

import java.io.Serializable;

/**
 * 漏洞利用配置类
 * 用于在不同标签页之间共享爆破结果
 */
public class ExploitConfig implements Serializable {
    private static final long serialVersionUID = 1L;

    // 单例实例
    private static ExploitConfig instance;

    // 配置字段
    private String targetUrl;
    private String key;
    private String gadget;
    private String echo;
    private String cookie;
    private String proxy;
    private String cryptType;
    private String rememberMeFlag;  // RememberMe Cookie 名称（keyword）
    private String requestType;     // 请求方式：GET 或 POST

    private ExploitConfig() {
        // 私有构造函数
    }

    /**
     * 获取单例实例
     */
    public static ExploitConfig getInstance() {
        if (instance == null) {
            instance = new ExploitConfig();
        }
        return instance;
    }

    /**
     * 更新配置
     */
    public void updateConfig(String targetUrl, String key, String gadget, String echo,
                            String cookie, String proxy, String cryptType, String rememberMeFlag, String requestType) {
        this.targetUrl = targetUrl;
        this.key = key;
        this.gadget = gadget;
        this.echo = echo;
        this.cookie = cookie;
        this.proxy = proxy;
        this.cryptType = cryptType;
        this.rememberMeFlag = rememberMeFlag;
        this.requestType = requestType;
    }

    /**
     * 检查配置是否完整
     */
    public boolean isComplete() {
        return targetUrl != null && !targetUrl.isEmpty() &&
                key != null && !key.isEmpty() &&
                gadget != null && !gadget.isEmpty() &&
                echo != null && !echo.isEmpty();
    }

    /**
     * 清空配置
     */
    public void clear() {
        this.targetUrl = null;
        this.key = null;
        this.gadget = null;
        this.echo = null;
        this.cookie = null;
        this.proxy = null;
        this.cryptType = null;
        this.rememberMeFlag = null;
        this.requestType = null;
    }

    // Getters and Setters
    public String getTargetUrl() {
        return targetUrl;
    }

    public void setTargetUrl(String targetUrl) {
        this.targetUrl = targetUrl;
    }

    public String getKey() {
        return key;
    }

    public void setKey(String key) {
        this.key = key;
    }

    public String getGadget() {
        return gadget;
    }

    public void setGadget(String gadget) {
        this.gadget = gadget;
    }

    public String getEcho() {
        return echo;
    }

    public void setEcho(String echo) {
        this.echo = echo;
    }

    public String getCookie() {
        return cookie;
    }

    public void setCookie(String cookie) {
        this.cookie = cookie;
    }

    public String getProxy() {
        return proxy;
    }

    public void setProxy(String proxy) {
        this.proxy = proxy;
    }

    public String getCryptType() {
        return cryptType;
    }

    public void setCryptType(String cryptType) {
        this.cryptType = cryptType;
    }

    public String getRememberMeFlag() {
        return rememberMeFlag;
    }

    public void setRememberMeFlag(String rememberMeFlag) {
        this.rememberMeFlag = rememberMeFlag;
    }

    public String getRequestType() {
        return requestType;
    }

    public void setRequestType(String requestType) {
        this.requestType = requestType;
    }

    @Override
    public String toString() {
        return "ExploitConfig{" +
                "targetUrl='" + targetUrl + '\'' +
                ", key='" + key + '\'' +
                ", gadget='" + gadget + '\'' +
                ", echo='" + echo + '\'' +
                ", cryptType='" + cryptType + '\'' +
                ", rememberMeFlag='" + rememberMeFlag + '\'' +
                ", requestType='" + requestType + '\'' +
                '}';
    }
}
